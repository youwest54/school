<!DOCTYPE html>
<html lang="en">
<head>

  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#1976d2">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="./icons/icon-192.png">
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Arabic–English–French Flash-cards</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Montserrat:wght@700&display=swap"
        rel="stylesheet">
  <style>
  html,body{height:100%;margin:0;padding:0;background:linear-gradient(135deg,#e0eafc 0%,#cfdef3 100%);
  font-family:'Inter','Segoe UI',Arial,sans-serif;color:#222;overscroll-behavior-y:contain;-webkit-tap-highlight-color:transparent}
  h1{font-family:'Montserrat',sans-serif;font-size:2.4rem;font-weight:700;color:#1976d2;text-align:center;margin:30px 0}
  .controls {
    text-align: center;
    margin-bottom: 20px;
  }
  .controls button {
    font-size: 1rem;
    padding: 8px 16px;
    margin: 0 8px;
    border: none;
    border-radius: 8px;
    background: #1976d2;
    color: white;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transition: background .2s;
  }
  .controls button:hover {
    background: #125ea9;
  }
  .flashcards{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
  gap:28px;justify-content:center;width:100%;max-width:1200px;padding:0 20px 20px}
  .flashcard{width:100%;min-width:260px;max-width:350px;height:210px;perspective:1200px;cursor:pointer;border-radius:30px;
  box-shadow:0 8px 28px rgba(44,62,80,.13);transition:box-shadow .22s,transform .13s}
  .flashcard:active{box-shadow:0 4px 12px rgba(33,150,243,.18);transform:scale(.98)}
  .flashcard-inner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .8s cubic-bezier(.4,2,.6,1)}
  .flashcard-content{position:absolute;width:100%;height:100%;backface-visibility:hidden;display:flex;justify-content:center;
  align-items:center;padding:24px 14px;font-size:1.22rem;font-weight:600;text-align:center;border-radius:30px;background:rgba(255,255,255,.78)}
  .flashcard-front{background:linear-gradient(135deg,#e3f2fd 0%,#fff 100%);}
  .flashcard-middle{background:linear-gradient(135deg,#bbdefb 0%,#e0f7fa 100%);transform:rotateY(-120deg)}
  .flashcard-back{background:linear-gradient(135deg,#b2dfdb 0%,#e0f2f1 100%);transform:rotateY(-240deg)}
  .voices-select{display:flex;gap:14px;flex-wrap:wrap;justify-content:center;margin-bottom:18px}
  .voices-select>div{background:rgba(255,255,255,.78);padding:12px 14px;border-radius:16px;box-shadow:0 2px 12px rgba(44,62,80,.08)}
  .voices-select label{font-size:1rem;font-weight:600;margin-bottom:3px}
  /* mobile tweaks trimmed for brevity – keep your originals if you need them */
  </style>
</head>
<body>
  <h1>Arabic–English–French Flash-cards</h1>

  <div class="controls">
    <button id="resetAllBtn" onclick="resetAllCards()">Reset All Cards</button>
    <button id="returnBtn" onclick="goToMainPage()">Return to Main Page</button>
  </div>

  <div class="voices-select">
    <div>
      <label for="arabicVoiceSelect">Arabic Voice:</label>
      <select id="arabicVoiceSelect"></select><br>
      <label><input type="checkbox" id="arabicMute" checked> Mute</label>
    </div>
    <div>
      <label for="englishVoiceSelect">English Voice:</label>
      <select id="englishVoiceSelect"></select><br>
      <label><input type="checkbox" id="englishMute"> Mute</label>
    </div>
    <div>
      <label for="frenchVoiceSelect">French Voice:</label>
      <select id="frenchVoiceSelect"></select><br>
      <label><input type="checkbox" id="frenchMute"> Mute</label>
    </div>
  </div>

  <div class="flashcards" id="flashcardsContainer">

    <div class="flashcard" id="flashcard-0" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>موت من الجوع</p></div>
        <div class="flashcard-content flashcard-middle"><p>To starve to death, to die of starvation</p></div>
        <div class="flashcard-content flashcard-back"><p>Mourir de faim, mourir de la famine</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-1" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>الطرف الآخر من الشارع التالي؟</p></div>
        <div class="flashcard-content flashcard-middle"><p>On the next block of the street</p></div>
        <div class="flashcard-content flashcard-back"><p>Au prochain pâté de maisons</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-2" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>حتى العرسان الجدد يتجادلون أحيانًا</p></div>
        <div class="flashcard-content flashcard-middle"><p>Even newlyweds sometimes argue</p></div>
        <div class="flashcard-content flashcard-back"><p>Même les jeunes mariés se disputent parfois</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-3" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>عرف زملاء روبرت أنه كان يتبع نظامًا غذائيًا ، لكنهم استمروا في إغرائه بالكعك</p></div>
        <div class="flashcard-content flashcard-middle"><p>Robert's colleagues knew he was on a diet, but they kept tempting him with cakes</p></div>
        <div class="flashcard-content flashcard-back"><p>Les collègues de Robert savaient qu'il était au régime, mais ils n'arrêtaient pas de le tenter avec des gâteaux</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-4" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>كل ما كان عليه فعله هو</p></div>
        <div class="flashcard-content flashcard-middle"><p>All what he had to do was</p></div>
        <div class="flashcard-content flashcard-back"><p>Tout ce qu'il avait à faire c'était</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-5" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>أحتاج إلى الذهاب إلى المتجر لشراء بعض الحليب - هل نحتاج إلى أي شيء آخر؟</p></div>
        <div class="flashcard-content flashcard-middle"><p>I need to pop down to the store for some milk—do we need anything else?</p></div>
        <div class="flashcard-content flashcard-back"><p>Je dois descendre au magasin chercher du lait—avons-nous besoin de quelque chose d'autre ?</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-6" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>لقد انتقلنا للتو إلى الطابق السفلي - يجب أن تزورنا يومًا ما!</p></div>
        <div class="flashcard-content flashcard-middle"><p>We just moved in on the floor below—you should pop down sometime!</p></div>
        <div class="flashcard-content flashcard-back"><p>Nous venons d'emménager à l'étage en dessous—vous devriez passer un de ces jours !</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-7" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>كنا في هذا الجزء من المدينة ، لذلك فكرت أن نزوركم.</p></div>
        <div class="flashcard-content flashcard-middle"><p>We were in this part of town, so I thought we'd pop down for a visit</p></div>
        <div class="flashcard-content flashcard-back"><p>Nous étions dans ce quartier, alors je me suis dit qu'on pourrait passer vous voir</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-8" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>فك انسداد المصرف</p></div>
        <div class="flashcard-content flashcard-middle"><p>Unclog the drain</p></div>
        <div class="flashcard-content flashcard-back"><p>Déboucher le drain</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-9" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>لقد لوّث قميصي</p></div>
        <div class="flashcard-content flashcard-middle"><p>He stained my shirt</p></div>
        <div class="flashcard-content flashcard-back"><p>Il a taché ma chemise</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-10" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>إنجاز</p></div>
        <div class="flashcard-content flashcard-middle"><p>Accomplishment</p></div>
        <div class="flashcard-content flashcard-back"><p>Accomplissement</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-11" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>بلاد ما بين النهرين كان اسم منطقة في الشرق الأوسط حيث نشأت الحضارة البشرية منذ آلاف السنين.</p></div>
        <div class="flashcard-content flashcard-middle"><p>Mesopotamia was the name of a region in the Middle East, where human civilization arose thousands of years ago.</p></div>
        <div class="flashcard-content flashcard-back"><p>La Mésopotamie était le nom d'une région du Moyen-Orient, où la civilisation humaine a vu le jour il y a des milliers d'années.</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-12" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>ربما سمعت بالسومريين، كانوا أقوى الناس هناك فيما أصبح يعرف بمهد الحضارة.</p></div>
        <div class="flashcard-content flashcard-middle"><p>You may have heard of the Sumerians. They were the most powerful people there—in what became known as the cradle of civilization.</p></div>
        <div class="flashcard-content flashcard-back"><p>Vous avez peut-être entendu parler des Sumériens. Ils étaient les plus puissants de la région, dans ce qu'on appelle le berceau de la civilisation.</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-13" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>ربما كان السومريون يعيشون في بيوت طينية، لكنهم كانوا متقدمين جدًا.</p></div>
        <div class="flashcard-content flashcard-middle"><p>The Sumerians may have lived in mud houses, but they were very sophisticated.</p></div>
        <div class="flashcard-content flashcard-back"><p>Les Sumériens vivaient peut-être dans des maisons en terre, mais ils étaient très sophistiqués.</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-14" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>لقد طوروا أول نظام كتابة.</p></div>
        <div class="flashcard-content flashcard-middle"><p>They developed the first writing system.</p></div>
        <div class="flashcard-content flashcard-back"><p>Ils ont développé le premier système d'écriture.</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-15" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>هي تضع القوانين هنا</p></div>
        <div class="flashcard-content flashcard-middle"><p>She lays down the laws around here</p></div>
        <div class="flashcard-content flashcard-back"><p>C'est elle qui fait les lois ici</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-16" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>صادفت مقالة مثيرة للاهتمام في الجريدة اليوم</p></div>
        <div class="flashcard-content flashcard-middle"><p>I came across an interesting article in the newspaper today</p></div>
        <div class="flashcard-content flashcard-back"><p>J'ai trouvé un article intéressant dans le journal aujourd'hui</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-17" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>البحيرة جفت</p></div>
        <div class="flashcard-content flashcard-middle"><p>Lake dried up</p></div>
        <div class="flashcard-content flashcard-back"><p>Le lac s'est asséché</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-18" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>ضحك خافت</p></div>
        <div class="flashcard-content flashcard-middle"><p>Giggling</p></div>
        <div class="flashcard-content flashcard-back"><p>Glousser</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-19" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>لم أتحدث معه منذ سنوات</p></div>
        <div class="flashcard-content flashcard-middle"><p>I haven't spoken to him in years</p></div>
        <div class="flashcard-content flashcard-back"><p>Je ne lui ai pas parlé depuis des années</p></div>
      </div>
    </div>

  </div><!-- /flashcards -->

  <script>
  /* ====================  High-quality voice handling  ==================== */
  let voices = [];
  const QUALITY = ['Siri','Premium','Enhanced','XL'];            // best → worst
  function bestVoice(code){                                     // 'ar' / 'en' / 'fr'
    return voices
      .filter(v=>v.lang.startsWith(code))
      .sort((a,b)=>{
         const qa = QUALITY.findIndex(q=>a.name.includes(q));
         const qb = QUALITY.findIndex(q=>b.name.includes(q));
         return (qa<0?QUALITY.length:qa) - (qb<0?QUALITY.length:qb);
      })[0] || null;
  }

  function populateVoices(){
    voices = speechSynthesis.getVoices();
    const map = [
      {code:'ar', sel:'arabicVoiceSelect'},
      {code:'en', sel:'englishVoiceSelect'},
      {code:'fr', sel:'frenchVoiceSelect'}
    ];
    map.forEach(({code,sel})=>{
      const dropdown = document.getElementById(sel);
      if (!dropdown) return;
      dropdown.innerHTML = '';
      const filteredVoices = voices.filter(v=>v.lang.startsWith(code));
      filteredVoices.forEach(v=>dropdown.add(new Option(`${v.name} (${v.lang})`, v.voiceURI)));
      // For French, prefer 'Thomas' if available
      if (code === 'fr') {
        const thomas = filteredVoices.find(v => v.name.toLowerCase().includes('thomas'));
        if (thomas) {
          dropdown.value = thomas.voiceURI;
          return;
        }
      }
      // For English, prefer 'Samantha' if available
      if (code === 'en') {
        const samantha = filteredVoices.find(v => v.name.toLowerCase().includes('samantha'));
        if (samantha) {
          dropdown.value = samantha.voiceURI;
          return;
        }
      }
      const preferred = bestVoice(code);
      if (preferred) dropdown.value = preferred.voiceURI;
      if (dropdown.length === 0) dropdown.add(new Option('No voice',''));
    });
  }

  /* wait for iOS to finish populating voices */
  if (speechSynthesis.getVoices().length){
    populateVoices();
  } else {
    const iv = setInterval(()=>{
      if (speechSynthesis.getVoices().length){
        clearInterval(iv); populateVoices();
      }
    }, 60);
  }
  speechSynthesis.onvoiceschanged = populateVoices;

  /* ======================  Speech helper  ====================== */
  function readAloud(text, langKey){              // langKey: 'arabic' | 'english' | 'french'
    if (document.getElementById(langKey+'Mute').checked) return;
    const codeMap = {arabic:'ar', english:'en', french:'fr'};
    const code = codeMap[langKey] || 'en';
    const dropdown = document.getElementById(langKey+'VoiceSelect');
    const chosen = voices.find(v=>v.voiceURI === dropdown.value);
    const voice  = chosen || bestVoice(code);
    if (!voice){ alert('No '+langKey+' voice installed'); return; }

    const u = new SpeechSynthesisUtterance(text);
    u.voice  = voice;
    u.lang   = voice.lang;
    u.rate   = 1;        // neutral pace
    u.pitch  = 1;        // neutral pitch
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
  }

  /* ======================  Reset & Return helpers ====================== */
  function resetAllCards() {
    document.querySelectorAll('.flashcard-inner').forEach(inner => {
      inner.style.transform = 'rotateY(0deg)';
      inner.setAttribute('data-rot', '0');
      inner.setAttribute('data-flip', 'arabic');
    });
  }

  function goToMainPage() {
    window.location.href = 'index_en.html';  // adjust to your main page URL
  }

  /* ======================  Card flipping  ====================== */
  function toggleFlipAndRead(card){
    const inner = card.querySelector('.flashcard-inner');
    const state = inner.getAttribute('data-flip');
    let rot = (parseInt(inner.getAttribute('data-rot')) + 120) % 360;
    inner.style.transform = `rotateY(${rot}deg)`;
    inner.setAttribute('data-rot', rot);

    const next = state==='arabic' ? 'english' : state==='english' ? 'french' : 'arabic';
    inner.setAttribute('data-flip', next);

    const sel = next==='arabic'  ? '.flashcard-front p'
              : next==='english' ? '.flashcard-middle p'
              : '.flashcard-back p';
    readAloud(inner.querySelector(sel).textContent, next);
  }
  </script>

  <script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./service-worker.js');
    });
  }
  </script>
</body>
</html>