<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#1976d2">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="./icons/icon-192.png">

  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Arabic–English–French Flash-cards</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Montserrat:wght@700&display=swap"
        rel="stylesheet">
  <style>
  html,body{height:100%;margin:0;padding:0;background:linear-gradient(135deg,#e0eafc 0%,#cfdef3 100%);
  font-family:'Inter','Segoe UI',Arial,sans-serif;color:#222;overscroll-behavior-y:contain;-webkit-tap-highlight-color:transparent}
  h1{font-family:'Montserrat',sans-serif;font-size:2.4rem;font-weight:700;color:#1976d2;text-align:center;margin:30px 0}
  .controls {
    text-align: center;
    margin-bottom: 20px;
  }
  .controls button {
    font-size: 1rem;
    padding: 8px 16px;
    margin: 0 8px;
    border: none;
    border-radius: 8px;
    background: #1976d2;
    color: white;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transition: background .2s;
  }
  .controls button:hover {
    background: #125ea9;
  }
  .flashcards{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
  gap:28px;justify-content:center;width:100%;max-width:1200px;padding:0 20px 20px}
  .flashcard{width:100%;min-width:260px;max-width:350px;height:210px;perspective:1200px;cursor:pointer;border-radius:30px;
  box-shadow:0 8px 28px rgba(44,62,80,.13);transition:box-shadow .22s,transform .13s}
  .flashcard:active{box-shadow:0 4px 12px rgba(33,150,243,.18);transform:scale(.98)}
  .flashcard-inner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .8s cubic-bezier(.4,2,.6,1)}
  .flashcard-content{position:absolute;width:100%;height:100%;backface-visibility:hidden;display:flex;justify-content:center;
  align-items:center;padding:24px 14px;font-size:1.22rem;font-weight:600;text-align:center;border-radius:30px;background:rgba(255,255,255,.78)}
  .flashcard-front{background:linear-gradient(135deg,#e3f2fd 0%,#fff 100%);}
  .flashcard-middle{background:linear-gradient(135deg,#bbdefb 0%,#e0f7fa 100%);transform:rotateY(-120deg)}
  .flashcard-back{background:linear-gradient(135deg,#b2dfdb 0%,#e0f2f1 100%);transform:rotateY(-240deg)}
  .voices-select{display:flex;gap:14px;flex-wrap:wrap;justify-content:center;margin-bottom:18px}
  .voices-select>div{background:rgba(255,255,255,.78);padding:12px 14px;border-radius:16px;box-shadow:0 2px 12px rgba(44,62,80,.08)}
  .voices-select label{font-size:1rem;font-weight:600;margin-bottom:3px}
  /* mobile tweaks trimmed for brevity – keep your originals if you need them */
  </style>
</head>
<body>
  <h1>Arabic–English–French Flash-cards</h1>

  <div class="controls">
    <button id="resetAllBtn" onclick="resetAllCards()">Reset All Cards</button>
    <button id="returnBtn" onclick="goToMainPage()">Return to Main Page</button>
  </div>

  <div class="voices-select">
    <div>
      <label for="arabicVoiceSelect">Arabic Voice:</label>
      <select id="arabicVoiceSelect"></select><br>
      <label><input type="checkbox" id="arabicMute" checked> Mute</label>
    </div>
    <div>
      <label for="englishVoiceSelect">English Voice:</label>
      <select id="englishVoiceSelect"></select><br>
      <label><input type="checkbox" id="englishMute"> Mute</label>
    </div>
    <div>
      <label for="frenchVoiceSelect">French Voice:</label>
      <select id="frenchVoiceSelect"></select><br>
      <label><input type="checkbox" id="frenchMute"> Mute</label>
    </div>
  </div>

  <div class="flashcards" id="flashcardsContainer">

    <div class="flashcard" id="flashcard-0" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>ينتقدون طريقتهم في التعبير عن أنفسهم</p></div>
        <div class="flashcard-content flashcard-middle"><p>They criticize their way of expressing themselves</p></div>
        <div class="flashcard-content flashcard-back"><p>En critiquant leur façon de s'exprimer</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-1" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>من الواضح ، لقد وجدت قانون نوفمبر 2019 منطقيًا مقارنة بالقانون المعلن. إذا كنت في قائمة الصفقات تحت الطلب ، لم يكن لديك سوى 6 أشهر للعمل قبل تقديم طلبك وانتقل الدعوى من الساعة 1800 إلى 900 ساعة</p></div>
        <div class="flashcard-content flashcard-middle"><p>"It's clear, I found the November 2019 law logical compared to the one announced. If you were in the list of in-demand jobs, you only had 6 months to work before applying, and the threshold of 1800 hours was reduced to 900 hours."</p></div>
        <div class="flashcard-content flashcard-back"><p>C'est clair, je trouvais la loi de novembre 2019 logique par rapport à celle annoncée. Si tu étais dans la liste de métiers en demande tu avais que 6 mois à travailler avant de faire ta demande et le seuil de 1800h passait à 900h.</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-2" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>هذا التصريح قد يسمح لهم باكتساب الخبرة اللازمة للعمل. ومع ذلك، فإن هذا التغيير قد يؤخر تقديم الطلب من خريجي كيبيك لمدة سنة أو سنتين</p></div>
        <div class="flashcard-content flashcard-middle"><p>This permit might allow them to gain the necessary job experience. However, this change would delay by one or two years the possibility for Quebec graduates to apply for PEQ.</p></div>
        <div class="flashcard-content flashcard-back"><p>Ce permis pourrait, on l'espère, leur permettre d'acquérir l'expérience nécessaire d'emploi. Néanmoins, ce changement retarderait d'un ou deux ans la possibilité pour les diplômés du Québec de déposer une demande de PEQ.</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-3" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>صندوق مالي</p></div>
        <div class="flashcard-content flashcard-middle"><p>Financial fund</p></div>
        <div class="flashcard-content flashcard-back"><p>Fonds financier</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-4" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>ثمين</p></div>
        <div class="flashcard-content flashcard-middle"><p>Precious</p></div>
        <div class="flashcard-content flashcard-back"><p>Précieux</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-5" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>تجميع</p></div>
        <div class="flashcard-content flashcard-middle"><p>Pooling (of resources)</p></div>
        <div class="flashcard-content flashcard-back"><p>Mutualisation</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-6" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>يجب أن يتم تقسيمه بالتساوي في العالم</p></div>
        <div class="flashcard-content flashcard-middle"><p>Must be divided equally in the world</p></div>
        <div class="flashcard-content flashcard-back"><p>Doit être divisé également dans le monde</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-7" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>من الوهم</p></div>
        <div class="flashcard-content flashcard-middle"><p>Of illusion</p></div>
        <div class="flashcard-content flashcard-back"><p>D'illusion</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-8" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>تهجئه</p></div>
        <div class="flashcard-content flashcard-middle"><p>Spell</p></div>
        <div class="flashcard-content flashcard-back"><p>Épeler</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-9" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>مقسم</p></div>
        <div class="flashcard-content flashcard-middle"><p>Split</p></div>
        <div class="flashcard-content flashcard-back"><p>Divisé</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-10" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>الاتحاد الأوروبي مات منذ انضمام الدول الشيوعية السابقة</p></div>
        <div class="flashcard-content flashcard-middle"><p>The European Union has died since the accession of the former communist countries</p></div>
        <div class="flashcard-content flashcard-back"><p>L'Union européenne est morte depuis l'adhésion des anciens pays communistes</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-11" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>لا يبدو أن حالتك تثير القلق.</p></div>
        <div class="flashcard-content flashcard-middle"><p>Your condition doesn’t seem concerning.</p></div>
        <div class="flashcard-content flashcard-back"><p>Votre état ne semble pas préoccupant.</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-12" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>التنافس</p></div>
        <div class="flashcard-content flashcard-middle"><p>Rivalry</p></div>
        <div class="flashcard-content flashcard-back"><p>La rivalité</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-13" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>الركود</p></div>
        <div class="flashcard-content flashcard-middle"><p>Recession</p></div>
        <div class="flashcard-content flashcard-back"><p>Récession</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-14" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>جبنة مبشورة</p></div>
        <div class="flashcard-content flashcard-middle"><p>Grated cheese</p></div>
        <div class="flashcard-content flashcard-back"><p>Fromage râpé</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-15" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>لقد أظهر لنا هذا الفيروس الكثير</p></div>
        <div class="flashcard-content flashcard-middle"><p>This virus has shown us a lot</p></div>
        <div class="flashcard-content flashcard-back"><p>Ce virus nous a montré beaucoup</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-16" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>السميد</p></div>
        <div class="flashcard-content flashcard-middle"><p>Semolina</p></div>
        <div class="flashcard-content flashcard-back"><p>La semoule</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-17" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>الطحين</p></div>
        <div class="flashcard-content flashcard-middle"><p>Flour</p></div>
        <div class="flashcard-content flashcard-back"><p>Farine</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-18" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>هناك تنافس كبير بين الشركات في سوق التكنولوجيا.</p></div>
        <div class="flashcard-content flashcard-middle"><p>There is a strong rivalry between companies in the tech market.</p></div>
        <div class="flashcard-content flashcard-back"><p>Il y a une forte concurrence entre les entreprises sur le marché technologique.</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-19" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>الخصومة بين الفريقين بدأت منذ سنوات.</p></div>
        <div class="flashcard-content flashcard-middle"><p>The rivalry between the two teams began years ago.</p></div>
        <div class="flashcard-content flashcard-back"><p>La rivalité entre les deux équipes a commencé il y a des années.</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-20" onclick="toggleFlipAndRead(this)"
         oncontextmenu="event.preventDefault()">
      <div class="flashcard-inner" data-flip="arabic" data-rot="0">
        <div class="flashcard-content flashcard-front"><p>العداء بين الجارين أدى إلى مشاكل كثيرة.</p></div>
        <div class="flashcard-content flashcard-middle"><p>The rivalry between the neighbors led to many problems.</p></div>
        <div class="flashcard-content flashcard-back"><p>L'hostilité entre les voisins a causé de nombreux problèmes.</p></div>
      </div>
    </div>

  </div><!-- /flashcards -->

  <script>
  /* ====================  High-quality voice handling  ==================== */
  let voices = [];
  const QUALITY = ['Siri','Premium','Enhanced','XL'];            // best → worst
  function bestVoice(code){                                     // 'ar' / 'en' / 'fr'
    return voices
      .filter(v=>v.lang.startsWith(code))
      .sort((a,b)=>{
         const qa = QUALITY.findIndex(q=>a.name.includes(q));
         const qb = QUALITY.findIndex(q=>b.name.includes(q));
         return (qa<0?QUALITY.length:qa) - (qb<0?QUALITY.length:qb);
      })[0] || null;
  }

  function populateVoices(){
    voices = speechSynthesis.getVoices();
    const map = [
      {code:'ar', sel:'arabicVoiceSelect'},
      {code:'en', sel:'englishVoiceSelect'},
      {code:'fr', sel:'frenchVoiceSelect'}
    ];
    map.forEach(({code,sel})=>{
      const dropdown = document.getElementById(sel);
      if (!dropdown) return;
      dropdown.innerHTML = '';
      const filteredVoices = voices.filter(v=>v.lang.startsWith(code));
      filteredVoices.forEach(v=>dropdown.add(new Option(`${v.name} (${v.lang})`, v.voiceURI)));
      // For French, prefer 'Thomas' if available
      if (code === 'fr') {
        const thomas = filteredVoices.find(v => v.name.toLowerCase().includes('thomas'));
        if (thomas) {
          dropdown.value = thomas.voiceURI;
          return;
        }
      }
      // For English, prefer 'Samantha' if available
      if (code === 'en') {
        const samantha = filteredVoices.find(v => v.name.toLowerCase().includes('samantha'));
        if (samantha) {
          dropdown.value = samantha.voiceURI;
          return;
        }
      }
      const preferred = bestVoice(code);
      if (preferred) dropdown.value = preferred.voiceURI;
      if (dropdown.length === 0) dropdown.add(new Option('No voice',''));
    });
  }

  /* wait for iOS to finish populating voices */
  if (speechSynthesis.getVoices().length){
    populateVoices();
  } else {
    const iv = setInterval(()=>{
      if (speechSynthesis.getVoices().length){
        clearInterval(iv); populateVoices();
      }
    }, 60);
  }
  speechSynthesis.onvoiceschanged = populateVoices;

  /* ======================  Speech helper  ====================== */
  function readAloud(text, langKey){              // langKey: 'arabic' | 'english' | 'french'
    if (document.getElementById(langKey+'Mute').checked) return;
    const codeMap = {arabic:'ar', english:'en', french:'fr'};
    const code = codeMap[langKey] || 'en';
    const dropdown = document.getElementById(langKey+'VoiceSelect');
    const chosen = voices.find(v=>v.voiceURI === dropdown.value);
    const voice  = chosen || bestVoice(code);
    if (!voice){ alert('No '+langKey+' voice installed'); return; }

    const u = new SpeechSynthesisUtterance(text);
    u.voice  = voice;
    u.lang   = voice.lang;
    u.rate   = 1;        // neutral pace
    u.pitch  = 1;        // neutral pitch
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
  }

  /* ======================  Reset & Return helpers ====================== */
  function resetAllCards() {
    document.querySelectorAll('.flashcard-inner').forEach(inner => {
      inner.style.transform = 'rotateY(0deg)';
      inner.setAttribute('data-rot', '0');
      inner.setAttribute('data-flip', 'arabic');
    });
  }

  function goToMainPage() {
    window.location.href = 'index_en.html';  // adjust to your main page URL
  }

  /* ======================  Card flipping  ====================== */
  function toggleFlipAndRead(card){
    const inner = card.querySelector('.flashcard-inner');
    const state = inner.getAttribute('data-flip');
    let rot = (parseInt(inner.getAttribute('data-rot')) + 120) % 360;
    inner.style.transform = `rotateY(${rot}deg)`;
    inner.setAttribute('data-rot', rot);

    const next = state==='arabic' ? 'english' : state==='english' ? 'french' : 'arabic';
    inner.setAttribute('data-flip', next);

    const sel = next==='arabic'  ? '.flashcard-front p'
              : next==='english' ? '.flashcard-middle p'
              : '.flashcard-back p';
    readAloud(inner.querySelector(sel).textContent, next);
  }
  </script>

<p style="margin:20px 0;">
  <a href="index_en.html">← Back to English index</a>
</p>

<script>
  if('serviceWorker' in navigator){
    window.addEventListener('load',()=>{
      navigator.serviceWorker.register('./service-worker.js');
    });
  }
</script>
</body>
</html>