<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Arabic-English-French Flashcards</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <style>
    html, body {
      height: 100%;
      margin: 0; padding: 0;
      background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      color: #222;
      -webkit-tap-highlight-color: transparent;
      overscroll-behavior-y: contain;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      width: 100vw;
      max-width: 100vw;
      overflow-x: hidden;
    }
    /* iPhone 13 specific adjustments */
    @media only screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) {
      html, body {
        font-size: 18px;
        padding: 0;
        margin: 0;
        width: 100vw;
        max-width: 100vw;
        overflow-x: hidden;
      }
      .flashcards {
        grid-template-columns: 1fr;
        padding: 0 4px 16px;
        gap: 18px;
      }
      .flashcard {
        min-width: 0;
        max-width: 98vw;
        height: 220px;
      }
      .controls button {
        font-size: 1.18rem;
        padding: 16px 0;
        width: 100%;
        min-height: 56px;
      }
      h1 {
        font-size: 2rem;
        margin: 18px 0 14px;
      }
    }
    /* General mobile tweaks */
    @media (max-width: 480px) {
      html, body {
        font-size: 17px;
        padding: 0;
        margin: 0;
        width: 100vw;
        max-width: 100vw;
        overflow-x: hidden;
      }
      .flashcards {
        grid-template-columns: 1fr;
        padding: 0 2px 12px;
        gap: 12px;
      }
      .flashcard {
        min-width: 0;
        max-width: 98vw;
        height: 180px;
      }
      .controls button {
        font-size: 1.1rem;
        padding: 14px 0;
        width: 100%;
        min-height: 48px;
      }
      h1 {
        font-size: 1.5rem;
        margin: 14px 0 10px;
      }
    }
    h1 {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.4rem; font-weight: 700;
      color: #1976d2; margin: 30px 0 24px;
      letter-spacing: 1.5px; text-align: center;
      text-shadow: 0 4px 18px rgba(33,150,243,0.08);
    }
    .voices-select {
      display: flex; gap: 14px; flex-wrap: wrap;
      justify-content: center; margin-bottom: 18px;
    }
    .voices-select > div {
      background: rgba(255,255,255,0.78);
      border-radius: 16px; box-shadow: 0 2px 12px rgba(44,62,80,0.08);
      padding: 12px 14px; display: flex; flex-direction: column;
      align-items: flex-start; min-width: 130px;
      backdrop-filter: blur(2px);
    }
    .voices-select label { font-size:1rem; font-weight:600; margin-bottom:3px; }
    select { font-size:1rem; padding:7px 12px; border-radius:8px; border:1px solid #bdbdbd; width:100%; margin-bottom:4px; }
    input[type="checkbox"] { width:20px; height:20px; }
    .controls {
      display:flex; flex-wrap:wrap; gap:14px;
      justify-content:center; margin:0 0 24px;
      position:fixed; top:0; left:0; right:0; z-index:100;
      background:rgba(255,255,255,0.96);
      backdrop-filter:blur(8px);
      border-radius:0 0 14px 14px;
      box-shadow:0 2px 12px rgba(33,150,243,0.09);
      padding:12px 0 6px;
      width:100vw;
      max-width:100vw;
      transition:transform 0.35s cubic-bezier(.4,2,.6,1);
      will-change: transform;
    }
    .controls.hide {
      transform: translateY(-120%);
    }
    .controls.show {
      transform: translateY(0);
    }
    body { padding-top: 70px; } /* prevent content from being hidden under fixed bar */
    .controls button {
      font-size:1.08rem; font-family:'Inter',Arial,sans-serif;
      padding:13px 24px;
      background:linear-gradient(90deg,#2196f3 0%,#21cbf3 100%);
      color:#fff; border:none; border-radius:12px;
      box-shadow:0 4px 18px rgba(33,150,243,0.13);
      font-weight:700; letter-spacing:0.5px;
      transition:background 0.18s,box-shadow 0.18s,transform 0.1s;
      cursor:pointer;
    }
    .controls button:active {
      background:linear-gradient(90deg,#1976d2 0%,#00bcd4 100%);
      box-shadow:0 2px 8px rgba(33,150,243,0.16);
      transform:scale(0.97);
    }
    .flashcards {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
      gap:28px; justify-content:center;
      width:100%; max-width:1200px; padding:0 20px 20px;
    }
    .flashcard {
      width:100%; min-width:260px; max-width:350px;
      height:210px; perspective:1200px; cursor:pointer;
      border-radius:30px;
      box-shadow:0 8px 28px rgba(44,62,80,0.13),
                 0 2px 8px rgba(33,150,243,0.08);
      background:transparent;
      transition:box-shadow 0.22s,transform 0.13s;
    }
    .flashcard:active {
      box-shadow:0 4px 12px rgba(33,150,243,0.18);
      transform:scale(0.98);
    }
    .flashcard-inner {
      width:100%; height:100%; position:relative;
      transform-style:preserve-3d;
      transition:transform 0.8s cubic-bezier(.4,2,.6,1);
      border-radius:30px;
      box-shadow:0 6px 32px rgba(33,150,243,0.10);
    }
    .flashcard-content {
      position:absolute; width:100%; height:100%;
      backface-visibility:hidden;
      display:flex; justify-content:center; align-items:center;
      padding:24px 14px; box-sizing:border-box;
      font-size:1.22rem; font-weight:600; letter-spacing:0.7px;
      text-align:center; color:#34495e;
      border-radius:30px; overflow:hidden; user-select:text;
      background:rgba(255,255,255,0.78);
      box-shadow:0 2px 18px rgba(33,150,243,0.06);
    }
    .flashcard-front {
      background:linear-gradient(135deg,#e3f2fd 0%,#fff 100%);
    }
    .flashcard-middle {
      background:linear-gradient(135deg,#bbdefb 0%,#e0f7fa 100%);
      transform:rotateY(-120deg);
    }
    .flashcard-back {
      background:linear-gradient(135deg,#b2dfdb 0%,#e0f2f1 100%);
      transform:rotateY(-240deg);
    }
    .custom-menu {
      display:none; position:absolute; z-index:1000;
      background:#fff; border:1px solid #ccc;
      box-shadow:0 8px 16px rgba(0,0,0,0.18);
      padding:10px 0; list-style:none; border-radius:10px;
      min-width:120px;
    }
    .custom-menu li {
      padding:10px 18px; cursor:pointer; font-size:1.08rem;
    }
    .custom-menu li:hover { background:#e3f2fd; }
  </style>
</head>
<body>
  <h1>Arabic-English-French Flashcards</h1>
  <div class="voices-select">
    <div>
      <label for="arabicVoiceSelect">Arabic Voice:</label>
      <select id="arabicVoiceSelect"></select>
      <label><input type="checkbox" id="arabicMute" checked> Mute</label>
    </div>
    <div>
      <label for="englishVoiceSelect">English Voice:</label>
      <select id="englishVoiceSelect"></select>
      <label><input type="checkbox" id="englishMute"> Mute</label>
    </div>
    <div>
      <label for="frenchVoiceSelect">French Voice:</label>
      <select id="frenchVoiceSelect"></select>
      <label><input type="checkbox" id="frenchMute"> Mute</label>
    </div>
  </div>
  <div class="controls">

  </div>
  <div class="flashcards" id="flashcardsContainer">

    <div class="flashcard" id="flashcard-0"
         onclick="toggleFlipAndRead(this);"
         oncontextmenu="showCustomMenu(event,0);">
      <div class="flashcard-inner" data-flip-state="arabic" data-rotation="0">
        <div class="flashcard-content flashcard-front"><p>تهج</p></div>
        <div class="flashcard-content flashcard-middle"><p>Spell</p></div>
        <div class="flashcard-content flashcard-back"><p>Épeler</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-1"
         onclick="toggleFlipAndRead(this);"
         oncontextmenu="showCustomMenu(event,1);">
      <div class="flashcard-inner" data-flip-state="arabic" data-rotation="0">
        <div class="flashcard-content flashcard-front"><p>منطقي</p></div>
        <div class="flashcard-content flashcard-middle"><p>coherent,clear,logical</p></div>
        <div class="flashcard-content flashcard-back"><p>Cohérent ,Un raisonnement cohérent</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-2"
         onclick="toggleFlipAndRead(this);"
         oncontextmenu="showCustomMenu(event,2);">
      <div class="flashcard-inner" data-flip-state="arabic" data-rotation="0">
        <div class="flashcard-content flashcard-front"><p>جسد رائع بروح قاتمة</p></div>
        <div class="flashcard-content flashcard-middle"><p>Gorgeous body with a dark spirit</p></div>
        <div class="flashcard-content flashcard-back"><p>Un corps magnifique avec une âme sombre</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-3"
         onclick="toggleFlipAndRead(this);"
         oncontextmenu="showCustomMenu(event,3);">
      <div class="flashcard-inner" data-flip-state="arabic" data-rotation="0">
        <div class="flashcard-content flashcard-front"><p>لا أحب التحدث بصيغ مطلقة</p></div>
        <div class="flashcard-content flashcard-middle"><p>I don’t like to talk in absolutes</p></div>
        <div class="flashcard-content flashcard-back"><p>Je n'aime pas parler en termes absolus</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-4"
         onclick="toggleFlipAndRead(this);"
         oncontextmenu="showCustomMenu(event,4);">
      <div class="flashcard-inner" data-flip-state="arabic" data-rotation="0">
        <div class="flashcard-content flashcard-front"><p>تحتفظ الشركة بسجلات مفصلة لكل المشتريات بهدف المساءلة</p></div>
        <div class="flashcard-content flashcard-middle"><p>The company keeps detailed records of all purchases for the sake of accountability</p></div>
        <div class="flashcard-content flashcard-back"><p>L'entreprise conserve le détail de tous ses achats dans un souci de rendre des comptes.</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-5"
         onclick="toggleFlipAndRead(this);"
         oncontextmenu="showCustomMenu(event,5);">
      <div class="flashcard-inner" data-flip-state="arabic" data-rotation="0">
        <div class="flashcard-content flashcard-front"><p>معفى</p></div>
        <div class="flashcard-content flashcard-middle"><p>Exempted</p></div>
        <div class="flashcard-content flashcard-back"><p>Exempté</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-6"
         onclick="toggleFlipAndRead(this);"
         oncontextmenu="showCustomMenu(event,6);">
      <div class="flashcard-inner" data-flip-state="arabic" data-rotation="0">
        <div class="flashcard-content flashcard-front"><p>الجماعية</p></div>
        <div class="flashcard-content flashcard-middle"><p>community values</p></div>
        <div class="flashcard-content flashcard-back"><p>Communautarisme</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-7"
         onclick="toggleFlipAndRead(this);"
         oncontextmenu="showCustomMenu(event,7);">
      <div class="flashcard-inner" data-flip-state="arabic" data-rotation="0">
        <div class="flashcard-content flashcard-front"><p>عدل النواب نص القانون هذا</p></div>
        <div class="flashcard-content flashcard-middle"><p>The deputies amended this law</p></div>
        <div class="flashcard-content flashcard-back"><p>Les députés ont amendé ce texte de loi</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-8"
         onclick="toggleFlipAndRead(this);"
         oncontextmenu="showCustomMenu(event,8);">
      <div class="flashcard-inner" data-flip-state="arabic" data-rotation="0">
        <div class="flashcard-content flashcard-front"><p>غير واعٍ , فاقد الوعي</p></div>
        <div class="flashcard-content flashcard-middle"><p>Unconscious,Unaware</p></div>
        <div class="flashcard-content flashcard-back"><p>Inconscient / ignorant</p></div>
      </div>
    </div>

    <div class="flashcard" id="flashcard-9"
         onclick="toggleFlipAndRead(this);"
         oncontextmenu="showCustomMenu(event,9);">
      <div class="flashcard-inner" data-flip-state="arabic" data-rotation="0">
        <div class="flashcard-content flashcard-front"><p>واللي يخلي مدينه نيورك متميزه</p></div>
        <div class="flashcard-content flashcard-middle"><p>What makes New York City special?</p></div>
        <div class="flashcard-content flashcard-back"><p>Qu'est-ce qui distingue la ville de New York ?</p></div>
      </div>
    </div>

  </div>
  <ul class="custom-menu" id="custom-menu">
    <li onclick="changeSelectedFlashcardColor('green')">Set to Green</li>
    <li onclick="changeSelectedFlashcardColor('red')">Set to Red</li>
    <li onclick="changeSelectedFlashcardColor('yellow')">Set to Yellow</li>
  </ul>
  <script>
    // VOICES
    let voices = [];
    function populateVoices() {
      voices = speechSynthesis.getVoices();
      // For each language, just list all voices for that language in the dropdown
      const arSel = document.getElementById('arabicVoiceSelect');
      if (arSel) {
        arSel.innerHTML = '';
        voices.filter(v=>v.lang.startsWith('ar')).forEach(v=>{
          const o = new Option(v.name+' ('+v.lang+')', v.voiceURI);
          arSel.add(o);
        });
        if (arSel.options.length === 0) {
          const o = new Option('No Arabic voice available', '');
          arSel.add(o);
        }
      }
      const enSel = document.getElementById('englishVoiceSelect');
      if (enSel) {
        enSel.innerHTML = '';
        voices.filter(v=>v.lang.startsWith('en')).forEach(v=>{
          const o = new Option(v.name+' ('+v.lang+')', v.voiceURI);
          enSel.add(o);
        });
        if (enSel.options.length === 0) {
          const o = new Option('No English voice available', '');
          enSel.add(o);
        }
      }
      const frSel = document.getElementById('frenchVoiceSelect');
      if (frSel) {
        frSel.innerHTML = '';
        voices.filter(v=>v.lang.startsWith('fr')).forEach(v=>{
          const o = new Option(v.name+' ('+v.lang+')', v.voiceURI);
          frSel.add(o);
        });
        if (frSel.options.length === 0) {
          const o = new Option('No French voice available', '');
          frSel.add(o);
        }
      }
    }
    speechSynthesis.onvoiceschanged = populateVoices;
    window.onload = populateVoices; 

    function readAloud(text, lang){
      const muteBox = document.getElementById(lang+'Mute');
      if (muteBox && muteBox.checked) {
        console.log('Mute is on for', lang);
        return;
      }
      if(!('speechSynthesis' in window)){
        alert('Text-to-speech is not supported in this browser.');
        return;
      }
      // Ensure voices are loaded
      if (!voices || voices.length === 0) {
        voices = speechSynthesis.getVoices();
        if (!voices || voices.length === 0) {
          alert('No speech voices available.');
          return;
        }
      }
      let sel = document.getElementById(lang+'VoiceSelect');
      let voiceURI = sel ? sel.value : null;
      let voice = voices.find(v=>v.voiceURI===voiceURI)
               || voices.find(v=>v.lang.startsWith(lang==='arabic'?'ar':lang==='english'?'en':'fr'));
      if(!voice) {
        alert('No matching voice found for ' + lang);
        return;
      }
      const u = new SpeechSynthesisUtterance(text);
      u.voice = voice; u.lang = voice.lang;
      u.rate = 0.97; // slightly slower, more natural
      u.pitch = 1.13; // slightly higher, more natural
      u.volume = 1.0;
      speechSynthesis.cancel();
      speechSynthesis.speak(u);
      console.log('Speaking:', text, 'with voice', voice.name, 'for', lang, 'rate:', u.rate, 'pitch:', u.pitch);
    }

    // HIDE/SHOW CONTROLS ON SCROLL
    let lastScrollY = window.scrollY;
    let controlsBar = document.querySelector('.controls');
    let ticking = false;
    function onScroll() {
      if (!controlsBar) controlsBar = document.querySelector('.controls');
      if (!controlsBar) return;
      if (window.scrollY > lastScrollY && window.scrollY > 30) {
        controlsBar.classList.add('hide');
        controlsBar.classList.remove('show');
      } else {
        controlsBar.classList.remove('hide');
        controlsBar.classList.add('show');
      }
      lastScrollY = window.scrollY;
    }
    window.addEventListener('scroll', function(){
      if (!ticking) {
        window.requestAnimationFrame(function() {
          onScroll();
          ticking = false;
        });
        ticking = true;
      }
    });
    if (controlsBar) controlsBar.classList.add('show');

    // FLIP & CONTROLS
    function shuffleFlashcards() {
      const container = document.getElementById('flashcardsContainer');
      const cards = Array.from(container.children);
      for (let i = cards.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        container.appendChild(cards[j]);
      }
    }
    function flipAllToArabic() {
      document.querySelectorAll('.flashcard-inner').forEach(inner => {
        inner.style.transform = '';
        inner.setAttribute('data-flip-state', 'arabic');
      });
    }
    function flipAllToEnglish() {
      document.querySelectorAll('.flashcard-inner').forEach(inner => {
        inner.style.transform = 'rotateY(120deg)';
        inner.setAttribute('data-flip-state', 'english');
      });
    }
    function flipAllToFrench() {
      document.querySelectorAll('.flashcard-inner').forEach(inner => {
        inner.style.transform = 'rotateY(240deg)';
        inner.setAttribute('data-flip-state', 'french');
      });
    }
    function toggleFlipAndRead(card){
      const inner = card.querySelector('.flashcard-inner');
      let state = inner.getAttribute('data-flip-state');
      let rot = (parseInt(inner.getAttribute('data-rotation')) + 120) % 360;
      inner.style.transform = `rotateY(${rot}deg)`;
      inner.setAttribute('data-rotation', rot);
      let next = state==='arabic'?'english': state==='english'?'french':'arabic';
      inner.setAttribute('data-flip-state', next);
      const sel = state==='arabic'? '.flashcard-middle p'
                : state==='english'? '.flashcard-back p'
                : '.flashcard-front p';
      readAloud(inner.querySelector(sel).textContent, state==='arabic'?'en':state==='english'?'fr':'ar');
    }
    function shuffleFlashcards(){
      const c = document.getElementById('flashcardsContainer');
      Array.from(c.children)
           .sort(()=>Math.random()-0.5)
           .forEach(n=>c.appendChild(n));
    }
    function flipAllToArabic(){
      document.querySelectorAll('.flashcard-inner').forEach(inner=>{
        inner.style.transform='rotateY(0deg)';
        inner.setAttribute('data-rotation','0');
        inner.setAttribute('data-flip-state','arabic');
      });
    }
    function flipAllToEnglish(){
      document.querySelectorAll('.flashcard-inner').forEach(inner=>{
        inner.style.transform='rotateY(120deg)';
        inner.setAttribute('data-rotation','120');
        inner.setAttribute('data-flip-state','english');
      });
    }
    function flipAllToFrench(){
      document.querySelectorAll('.flashcard-inner').forEach(inner=>{
        inner.style.transform='rotateY(240deg)';
        inner.setAttribute('data-rotation','240');
        inner.setAttribute('data-flip-state','french');
      });
    }

    // CUSTOM MENU
    function showCustomMenu(e, idx){
      e.preventDefault();
      const m = document.getElementById('custom-menu');
      m.style.display='block';
      m.style.left=e.pageX+'px';
      m.style.top=e.pageY+'px';
      m.dataset.idx=idx;
    }
    function changeSelectedFlashcardColor(color){
      const idx = document.getElementById('custom-menu').dataset.idx;
      const f = document.querySelector(`#flashcard-${idx} .flashcard-front`);
      const bg = color==='green'? '#28a745' : color==='red'? '#dc3545':'#ffeb3b';
      f.style.background=bg; f.style.color='#fff';
      document.getElementById('custom-menu').style.display='none';
    }
    document.addEventListener('click', ()=> {
      document.getElementById('custom-menu').style.display='none';
    });
  </script>
</body>
</html>
