<!DOCTYPE html>
<html lang="ar"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Flashcards</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,sans-serif;
     background:#fafafa;color:#333;max-width:600px;margin:0 auto;padding:1rem;
     padding-bottom:4rem}
h1{text-align:center;margin-bottom:1rem;font-size:1.8rem}
.flashcard{background:#fff;border:1px solid #ddd;border-radius:12px;
           padding:1.5rem;margin-bottom:1.5rem;position:relative;
           touch-action:manipulation;min-height:200px;cursor:pointer}
.flashcard.remembered{border-color:#43a047}
.remembered-badge{position:absolute;top:8px;right:12px;background:#43a047;
                  color:#fff;border-radius:8px;padding:2px 6px;font-size:.75rem;
                  display:none}
.flashcard.remembered .remembered-badge{display:block}
.content{font-size:1.5rem;min-height:7em;display:flex;align-items:center;
         justify-content:center;margin-bottom:.75rem}
.buttons{display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center}
.buttons button{flex:1 1 30%;padding:.5rem;font-size:1rem;border:none;
                border-radius:8px;cursor:pointer}
.remember-button{background:#eee;color:#333}
.remember-button.remembered{background:#43a047;color:#fff}
.play-button{flex:none;width:4rem;height:4rem;padding:0;border:none;
             border-radius:50%;font-size:2.5rem;background:#fff;color:#1976d2;
             display:flex;align-items:center;justify-content:center;cursor:pointer;
             box-shadow:0 2px 6px rgba(0,0,0,.2)}
.modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;
       background:rgba(0,0,0,.5);align-items:center;justify-content:center;
       z-index:1000}
.modal-content{background:#fff;border-radius:12px;padding:1.5rem;
               max-width:90%;width:320px}
.modal-content h2{margin-bottom:.5rem;font-size:1.2rem}
.modal-content label{display:block;margin:.5rem 0 .25rem}
.modal-content select,
.modal-content input[type=range]{width:100%}
.modal-content .close{float:right;font-size:1.2rem;cursor:pointer}
.lang-settings{padding:1rem 0;margin-bottom:1.5rem;min-height:180px}
#settings-button,#flip-all-button{position:fixed;bottom:1rem;z-index:1001;
  background:#fff;border:none;border-radius:50%;width:4rem;height:4rem;
  padding:0;font-size:2.5rem;display:flex;align-items:center;justify-content:center;
  cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.2)}
#flip-all-button{right:6rem}#settings-button{right:1rem}

 /* ---------- 10 rem Return button that respects the iPhone safe-area ---------- */
#return-button{
  position:fixed;
  bottom:calc(env(safe-area-inset-bottom,0) + 1rem);
  left:  calc(env(safe-area-inset-left ,0) + 1rem);

  width:10rem;
  height:10rem;
  font-size:4rem;

  border:none;
  border-radius:50%;
  background:#1976d2;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 3px 8px rgba(0,0,0,.25);
  z-index:1002;
  cursor:pointer;
  touch-action:manipulation;
}
/* auto-shrink on very small screens (e.g. iPhone SE) */
@media (max-width:375px){
  #return-button{
    width:7rem;
    height:7rem;
    font-size:3rem;
  }
}
</style>
</head><body>
<h1>Flashcards</h1>
<button id="flip-all-button" title="Flip all cards">üîÑ</button>
<button id="settings-button"  title="Settings">‚öôÔ∏è</button>
<div id="card-container"></div>

<!-- Settings modal ---------------------------------------------------------->
<div id="settings-modal" class="modal"><div class="modal-content">
<span class="close" title="Close">√ó</span><h2>Voice Settings</h2>
<div class="lang-settings" data-lang="ar">
  <label>Arabic voice:</label>
  <select class="voice-select"></select>
  <label>Rate: <span class="rate-value">1</span></label>
  <input type="range" class="rate-range" min="0.5" max="2" step="0.1" value="1">
  <label>Pitch: <span class="pitch-value">1</span></label>
  <input type="range" class="pitch-range" min="0" max="2" step="0.1" value="1">
</div><hr>
<div class="lang-settings" data-lang="en">
  <label>English voice:</label>
  <select class="voice-select"></select>
  <label>Rate: <span class="rate-value">1</span></label>
  <input type="range" class="rate-range" min="0.5" max="2" step="0.1" value="1">
  <label>Pitch: <span class="pitch-value">1</span></label>
  <input type="range" class="pitch-range" min="0" max="2" step="0.1" value="1">
</div><hr>
<div class="lang-settings" data-lang="fr">
  <label>French voice:</label>
  <select class="voice-select"></select>
  <label>Rate: <span class="rate-value">1</span></label>
  <input type="range" class="rate-range" min="0.5" max="2" step="0.1" value="1">
  <label>Pitch: <span class="pitch-value">1</span></label>
  <input type="range" class="pitch-range" min="0" max="2" step="0.1" value="1">
</div><hr>
</div></div>

<button id="return-button" title="Return">‚Üê</button>

<script>
const LANGS = ["ar", "en", "fr"];
const CARDS = [{"ar": "ÿ£ÿ™ÿ≠ÿØÿßŸÉ ÿ£ŸÜ ÿ™ŸÖŸÑŸä ÿπŸÑŸäŸë ŸÉŸäŸÅ ÿ£ÿπŸäÿ¥ ÿ≠Ÿäÿßÿ™Ÿä.", "en": "I defy you to dictate how I should live my life.", "fr": "Je te d√©fie de me dicter comment je devrais vivre ma vie."}, {"ar": "ÿ∑ŸÑÿ® ÿßŸÑÿØŸÅÿßÿπ ÿπŸÜ ÿ¥ÿÆÿµ ÿ£Ÿà ÿ™ÿØŸÖŸäÿ± ÿ¥ÿÆÿµ", "en": "Ask to defend someone or crush someone", "fr": "Demander de d√©fendre quelqu‚Äôun ou fracasser quelqu‚Äôun"}, {"ar": "ŸÖÿ≥ÿ™ŸáÿØŸÅ ÿßŸÜÿ™ÿÆÿßÿ®ŸäŸãÿß", "en": "Electoral target", "fr": "Cibl√© √©lectoral"}, {"ar": "ÿßŸÑÿ¥ÿÆÿµ ÿßŸÑÿ∞Ÿä Ÿäÿ™ŸÅÿßÿÆÿ± ÿ®ŸÅÿ∂ŸÑŸá ÿπŸÑŸâ ÿ¥ÿÆÿµ ÿ¢ÿÆÿ±", "en": "One who boasts of his favours done to another", "fr": "Celui qui se vante des faveurs qu'il a rendues √† un autre"}, {"ar": "ŸÖÿπŸäÿ®", "en": "Flawed", "fr": "D√©faut"}, {"ar": "ÿßŸÑÿØŸàŸÑÿ© ÿßŸÑÿ£ŸÉÿ´ÿ± ÿ™ÿ∑Ÿàÿ±Ÿãÿß ŸÖŸÜ ÿ≠Ÿäÿ´ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿ© ÿßŸÑÿ≤ÿ±ÿßÿπŸäÿ©", "en": "The most developed country in terms of agricultural technology products", "fr": "Le pays le plus d√©velopp√© au niveau des produits technologiques agricoles"}, {"ar": "ŸÜÿ≥ÿ®ÿ© ŸÉÿ®Ÿäÿ±ÿ© ŸÖŸÜ ÿ≥ŸÉÿßŸÜ ÿßŸÑŸáŸÜÿØ Ÿäÿπÿ™ŸÖÿØŸàŸÜ ÿπŸÑŸâ ÿßŸÑÿ≤ÿ±ÿßÿπÿ© ŸàÿßŸÑŸÖÿ≤ÿßÿ±ÿπ ŸÑŸÉÿ≥ÿ® ÿßŸÑÿØÿÆŸÑ.", "en": "A large portion of the Indian population relies on agriculture and plantations for income.", "fr": "Une grosse partie de la population indienne s'appuie sur l'agriculture et les plantations pour son revenu."}, {"ar": "ÿ´ŸÜÿßÿ¶Ÿä", "en": "Bilateral", "fr": "Bilat√©ral"}, {"ar": "ŸÖÿ≠ÿßŸÖ", "en": "Attorney", "fr": "Avocat"}, {"ar": "ŸÖÿπŸäŸÜ", "en": "Appointed", "fr": "Nomm√©"}, {"ar": "ÿÆÿ∑ÿßÿ®", "en": "Allocution", "fr": "Allocution"}, {"ar": "ÿ£ŸÜÿ™ ŸÖÿ¨ÿ±ÿØ ÿ¥ÿÆÿµ ÿ™ÿßŸÅŸá", "en": "You‚Äôre just a lightweight", "fr": "Tu n‚Äôes qu‚Äôun poids l√©ger / peu influent"}, {"ar": "ÿßŸÑÿ™ŸàÿØÿØ/ÿ≥ŸÖÿ≥ÿßÿ±", "en": "Courting / Broker", "fr": "Courtisage / Courtier"}, {"ar": "ÿ™ÿ¨ÿØŸäŸÅ", "en": "Blasphemy", "fr": "Blasph√®me"}, {"ar": "ÿßŸÑÿØÿ®ŸÑÿ¨ÿ©", "en": "Dubbing", "fr": "Doublage"}, {"ar": "ŸÖÿµÿßÿØÿ± ÿßŸÑÿ¨ŸàÿßŸÜÿ® ÿßŸÑŸÖÿ™ŸÅŸÇ ÿπŸÑŸäŸáÿß", "en": "Connot side sources", "fr": "Sources connues"}, {"ar": "ÿßŸÑÿ±ÿ®ÿß", "en": "Usury", "fr": "Usure"}, {"ar": "ÿ£ÿ≠ÿØ ÿ£ÿ≥ÿ®ÿßÿ® ÿØÿπŸÖ Ÿáÿ∞ÿß ÿßŸÑÿ®ŸÑÿØ ŸáŸà Ÿàÿ¨ŸàÿØ ŸÖÿµŸÑÿ≠ÿ© ŸÖÿßÿØŸäÿ©.", "en": "One of the reasons why this country has a lot of support is because there‚Äôs a material interest.", "fr": "L'une des raisons pour lesquelles ce pays a beaucoup de soutien est qu'il y a un int√©r√™t mat√©riel."}, {"ar": "ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÜÿßÿ°ÿßÿ™ ÿßŸÑÿ™Ÿä ÿ™ÿ§ŸÉÿØ ÿßŸÑŸÇÿßÿπÿØÿ©", "en": "The exceptions that prove the rule.", "fr": "Les exceptions qui confirment la r√®gle."}, {"ar": "ŸäŸÖŸÉŸÜ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ™ŸÑÿßÿπÿ® ÿ®ÿßŸÑŸÉŸÑŸÖÿßÿ™ ŸÑÿ•ŸÜÿ¥ÿßÿ° ÿµŸàÿ±ÿ© ÿ£Ÿà ÿßŸÜÿ∑ÿ®ÿßÿπ ŸÖÿπŸäŸÜ ŸÅŸä ÿ£ÿ∞ŸáÿßŸÜ ÿßŸÑÿ¨ŸÖŸáŸàÿ±.", "en": "Wordplay can be used to create a specific image or impression in the minds of the audience.", "fr": "Les jeux de mots peuvent √™tre utilis√©s pour cr√©er une image ou une impression particuli√®re dans l'esprit du public."}, {"ar": "ÿ®ÿØŸàŸÜ Ÿàÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ™ŸàÿßÿµŸÑ ÿßŸÑÿßÿ¨ÿ™ŸÖÿßÿπŸäÿå ŸÑŸÉÿßŸÜ ŸÖŸÜ ÿßŸÑÿ£ÿ≥ŸáŸÑ ŸÑŸáŸÖ ÿ•ÿÆŸÅÿßÿ° ÿ®ÿπÿ∂ ÿßŸÑÿ≠ŸÇÿßÿ¶ŸÇ ÿßŸÑŸÖÿ™ÿπŸÑŸÇÿ© ÿ®ÿßŸÑÿ¥ÿ±ÿ∑ÿ©.", "en": "Without social media, it would have been easier for them to conceal certain truths related to the police.", "fr": "Sans les r√©seaux sociaux, il aurait √©t√© plus facile pour eux de dissimuler certaines v√©rit√©s li√©es √† la police."}, {"ar": "ÿ®ÿßŸÑÿ∑ÿ®ÿπ: \"ŸÑŸÇÿØ ÿ¨ÿπŸÑÿ™ Ÿàÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ™ŸàÿßÿµŸÑ ÿßŸÑÿßÿ¨ÿ™ŸÖÿßÿπŸä ŸÖŸÜ ÿßŸÑÿµÿπÿ® ÿπŸÑŸâ ÿßŸÑÿ≥ŸÑÿ∑ÿßÿ™ ÿ•ÿÆŸÅÿßÿ° ÿ®ÿπÿ∂ ÿßŸÑÿ≠ŸÇÿßÿ¶ŸÇ ÿßŸÑÿ™Ÿä ÿ≠ÿØÿ´ÿ™ ŸÖÿπ ÿßŸÑÿ¥ÿ±ÿ∑ÿ©.\"", "en": "Of course: \"Social media has made it harder for the authorities to hide some truths that have occurred with police.\"", "fr": "Bien s√ªr : \"Les r√©seaux sociaux ont rendu plus difficile pour les autorit√©s de cacher certaines v√©rit√©s qui se sont produites avec la police.\""}, {"ar": "ÿµÿ≠Ÿäÿ≠ÿå ŸÖŸàÿßŸÇÿπ ÿßŸÑÿ™ŸàÿßÿµŸÑ ÿßŸÑÿßÿ¨ÿ™ŸÖÿßÿπŸä ÿ≥ÿßŸáŸÖÿ™ ŸÅŸä ÿ¨ÿπŸÑ ÿßŸÑÿ£ŸÖŸàÿ± ÿ£ŸÉÿ´ÿ± ÿ¥ŸÅÿßŸÅŸäÿ© ŸàŸÇÿØ ÿ™ÿ¨ŸÜÿ®ÿ™ ÿßŸÑÿ≥ŸÑÿ∑ÿßÿ™ ÿ•ÿÆŸÅÿßÿ° ÿ®ÿπÿ∂ ÿßŸÑÿ≠ŸÇÿßÿ¶ŸÇ ÿ®ŸÅÿ∂ŸÑ Ÿáÿ∞Ÿá ÿßŸÑŸàÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ™ŸÇŸÜŸäÿ©.", "en": "True, social media has contributed to making things more transparent, and the authorities avoided hiding some facts thanks to these technological tools.", "fr": "Correct, les r√©seaux sociaux ont aid√© √† rendre les choses plus transparentes, et les autorit√©s ont √©vit√© de cacher certaines v√©rit√©s gr√¢ce √† ces moyens techniques."}, {"ar": "ŸÑŸÖÿßÿ∞ÿßÿå ŸÅŸä ÿßŸÑÿ•ÿπŸÑÿßŸÖ ÿßŸÑŸÅÿ±ŸÜÿ≥Ÿäÿå ÿπŸÜÿØŸÖÿß ŸäŸÜÿßŸÇÿ¥ŸàŸÜ ŸÖŸàÿ∂ŸàÿπŸãÿß ÿ£ÿ¨ŸÜÿ®ŸäŸãÿßÿå Ÿäÿ≥ÿ™ÿ∂ŸäŸÅŸàŸÜ ŸÅŸÇÿ∑ ŸÖÿ≠ŸÑŸÑŸäŸÜ ŸÅÿ±ŸÜÿ≥ŸäŸäŸÜÿü", "en": "Why, in French media, when discussing a foreign topic, do they only invite French analysts?", "fr": "Pourquoi, dans les m√©dias fran√ßais, lorsqu'on aborde un sujet √©tranger, on invite que des analystes fran√ßais ?"}, {"ar": "ÿ™ŸÖ ÿ∑ÿπŸÜ ÿßŸÑŸÖŸÑŸÉ", "en": "The king was stabbed", "fr": "Le roi a √©t√© poignard√©"}, {"ar": "ÿ£ÿ™ÿ≠ÿØÿßŸÉ ÿ£ŸÜ ÿ™ŸÇŸàŸÑ ÿßŸÑÿ≠ŸÇŸäŸÇÿ©", "en": "I dare you to tell the truth", "fr": "Je te mets au d√©fi de dire la v√©rit√©"}];

//  Remembered state ---------------------------------------------------------
let remembered = {};
try { remembered = JSON.parse(localStorage.getItem('flashcardRemembered')) || {}; } catch(e) {}
function saveRemembered(){ localStorage.setItem('flashcardRemembered', JSON.stringify(remembered)); }

//  Voice settings blob ------------------------------------------------------
const voiceSettings = Object.fromEntries(LANGS.map(l => [l,{voiceURI:null,rate:1,pitch:1}]));
try{{ Object.assign(voiceSettings, JSON.parse(localStorage.getItem('flashcardVoiceSettings')||'{{}}')); }}catch(e){{}}

//  Populate <select> on voices load ----------------------------------------
function populateVoiceSelects(){ const vlist = speechSynthesis.getVoices();
  document.querySelectorAll('.lang-settings').forEach(cfg=>{
      const lang=cfg.dataset.lang,sel=cfg.querySelector('.voice-select');
      sel.innerHTML='';
      vlist.filter(v=>v.lang.startsWith(lang))
           .forEach(v=>sel.append(new Option(`${v.name} (${v.lang})`,v.voiceURI)));
      sel.value = voiceSettings[lang].voiceURI || '';
  });
}
speechSynthesis.onvoiceschanged = populateVoiceSelects;

//  Build one card -----------------------------------------------------------
function createCard(data,idx){ const card=document.createElement('div');
  card.className='flashcard'; card.dataset.side=0;
  const badge=document.createElement('span'); badge.className='remembered-badge'; badge.textContent='Remembered ‚úì'; card.append(badge);
  const content=document.createElement('div'); content.className='content'; card.append(content);
  const render=()=>content.textContent=data[LANGS[+card.dataset.side]]||''; render();

  card.onclick=e=>{ if(e.target.closest('button'))return;
    card.dataset.side=(+card.dataset.side+1)%LANGS.length; render(); };

  const btns=document.createElement('div'); btns.className='buttons'; card.append(btns);

  const rem=document.createElement('button'); rem.className='remember-button';
  const applyR=st=>{{ card.classList.toggle('remembered',st); rem.classList.toggle('remembered',st);
                      rem.textContent=st?'Unmark Remembered':'Mark as Remembered'; }};
  applyR(!!remembered[idx]);
  rem.onclick=()=>{{ remembered[idx]=!remembered[idx]; applyR(remembered[idx]); saveRemembered(); }};
  btns.append(rem);

  const play=document.createElement('button'); play.className='play-button'; play.textContent='üîä';
  play.onclick=()=>{{ const side=+card.dataset.side,lang=LANGS[side],txt=data[lang]||'';
      const u=new SpeechSynthesisUtterance(txt),cfg=voiceSettings[lang];
      if(cfg.voiceURI)u.voice=speechSynthesis.getVoices().find(v=>v.voiceURI===cfg.voiceURI); else u.lang=lang;
      u.rate=cfg.rate; u.pitch=cfg.pitch; speechSynthesis.speak(u); }};
  btns.append(play);

  return card;
}

//  Settings modal -----------------------------------------------------------
const modal=document.getElementById('settings-modal');
document.getElementById('settings-button').onclick=()=>{{ populateVoiceSelects(); modal.style.display='flex'; }};
modal.querySelector('.close').onclick=()=>{{ modal.style.display='none';
    localStorage.setItem('flashcardVoiceSettings',JSON.stringify(voiceSettings)); }};
document.querySelectorAll('.lang-settings').forEach(cfg=>{{
    const lang=cfg.dataset.lang;
    cfg.querySelector('.voice-select').onchange=e=>voiceSettings[lang].voiceURI=e.target.value;
    const rate=cfg.querySelector('.rate-range'),rv=cfg.querySelector('.rate-value');
    rate.oninput=e=>{{ rv.textContent=e.target.value; voiceSettings[lang].rate=+e.target.value; }};
    rate.value=voiceSettings[lang].rate; rv.textContent=rate.value;
    const pitch=cfg.querySelector('.pitch-range'),pv=cfg.querySelector('.pitch-value');
    pitch.oninput=e=>{{ pv.textContent=e.target.value; voiceSettings[lang].pitch=+e.target.value; }};
    pitch.value=voiceSettings[lang].pitch; pv.textContent=pitch.value;
}});

//  Flip-all button ----------------------------------------------------------
document.getElementById('flip-all-button').onclick=()=>document.querySelectorAll('.flashcard').forEach((c,i)=>{{
    c.dataset.side=0; c.querySelector('.content').textContent=CARDS[i][LANGS[0]]||''; }});

//  Build cards on DOM ready -------------------------------------------------
window.addEventListener('DOMContentLoaded',()=>{{
    const cont=document.getElementById('card-container'); CARDS.forEach((d,i)=>cont.append(createCard(d,i)));
    if('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js');
}});

//  ---- Return button with graceful fallback -------------------------------
document.getElementById('return-button').onclick=()=>{{
    if(history.length>1) history.back();
    else location.href='index.html';   // ‚óÄÔ∏è change if your ‚Äúhome‚Äù isn‚Äôt index.html
}};
</script>
</body></html>