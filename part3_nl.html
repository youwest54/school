<!DOCTYPE html>
<html lang="fr"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Flash-cards</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,sans-serif;
     background:#fafafa;color:#333;max-width:600px;margin:0 auto;padding:1rem;
     padding-bottom:4rem}
h1{text-align:center;margin-bottom:1rem;font-size:1.8rem}
.flashcard{background:#fff;border:1px solid #ddd;border-radius:12px;
           padding:1.5rem;margin-bottom:1.5rem;position:relative;
           touch-action:manipulation;min-height:200px;cursor:pointer}
.flashcard.remembered{border-color:#43a047}
.remembered-badge{position:absolute;top:8px;right:12px;background:#43a047;
                  color:#fff;border-radius:8px;padding:2px 6px;font-size:.75rem;
                  display:none}
.flashcard.remembered .remembered-badge{display:block}
.content{font-size:1.5rem;min-height:7em;display:flex;align-items:center;
         justify-content:center;margin-bottom:.75rem}
.buttons{display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center}
.buttons button{flex:1 1 30%;padding:.5rem;font-size:1rem;border:none;
                border-radius:8px;cursor:pointer}
.remember-button{background:#eee;color:#333}
.remember-button.remembered{background:#43a047;color:#fff}
.play-button{flex:none;width:4rem;height:4rem;padding:0;border:none;
             border-radius:50%;font-size:2.5rem;background:#fff;color:#1976d2;
             display:flex;align-items:center;justify-content:center;cursor:pointer;
             box-shadow:0 2px 6px rgba(0,0,0,.2)}
.modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;
       background:rgba(0,0,0,.5);align-items:center;justify-content:center;
       z-index:1000}
.modal-content{background:#fff;border-radius:12px;padding:1.5rem;
               max-width:90%;width:320px}
.modal-content h2{margin-bottom:.5rem;font-size:1.2rem}
.modal-content label{display:block;margin:.5rem 0 .25rem}
.modal-content select,
.modal-content input[type=range]{width:100%}
.modal-content .close{float:right;font-size:1.2rem;cursor:pointer}
.lang-settings{padding:1rem 0;margin-bottom:1.5rem;min-height:180px}
#settings-button,#flip-all-button{position:fixed;bottom:1rem;z-index:1001;
  background:#fff;border:none;border-radius:50%;width:4rem;height:4rem;
  padding:0;font-size:2.5rem;display:flex;align-items:center;justify-content:center;
  cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.2)}
#flip-all-button{right:6rem}#settings-button{right:1rem}
#return-button{position:fixed;bottom:1rem;left:1rem;background:#1976d2;color:#fff;
  border:none;border-radius:50%;width:3.5rem;height:3.5rem;padding:0;font-size:2rem;
  display:flex;align-items:center;justify-content:center;cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,.2)}
</style>
</head><body>
<h1>Flashcards</h1>
<button id="flip-all-button" title="Flip all cards">üîÑ</button>
<button id="settings-button"  title="Settings">‚öôÔ∏è</button>
<div id="card-container"></div>

<!-- Settings modal ---------------------------------------------------------->
<div id="settings-modal" class="modal"><div class="modal-content">
<span class="close" title="Close">√ó</span><h2>Voice Settings</h2>
<div class="lang-settings" data-lang="fr">
  <label>French voice:</label>
  <select class="voice-select"></select>
  <label>Rate: <span class="rate-value">1</span></label>
  <input type="range" class="rate-range" min="0.5" max="2" step="0.1" value="1">
  <label>Pitch: <span class="pitch-value">1</span></label>
  <input type="range" class="pitch-range" min="0" max="2" step="0.1" value="1">
</div><hr>
<div class="lang-settings" data-lang="nl">
  <label>Dutch voice:</label>
  <select class="voice-select"></select>
  <label>Rate: <span class="rate-value">1</span></label>
  <input type="range" class="rate-range" min="0.5" max="2" step="0.1" value="1">
  <label>Pitch: <span class="pitch-value">1</span></label>
  <input type="range" class="pitch-range" min="0" max="2" step="0.1" value="1">
</div><hr>
</div></div>

<button id="return-button" onclick="history.back()" title="Return">‚Üê</button>

<script>
const LANGS  = ["fr", "nl"];
const CARDS  = [{"fr": "Ou habite-tu ?", "nl": "Waar woon je?"}, {"fr": "J'aimerais savoir", "nl": "Ik wil graag weten"}, {"fr": "J'ai un rendez-vous aujourd'hui √† 15 heures", "nl": "Ik heb vandaag om 15 uur een afspraak"}, {"fr": "J'ai un RDV", "nl": "Ik heb een afspraak"}, {"fr": "J'ai un vol √† 10h30", "nl": "Ik heb een vlucht om 10.30 uur"}, {"fr": "Ik moet vertrekken", "nl": "Il faut que je parte"}, {"fr": "Il faut que je parte au travail", "nl": "Ik moet naar mijn werk vertrekken"}, {"fr": "J'ai besoin du DXF s'il vous pla√Æt", "nl": "Ik heb de DXF nodig, alstublieft"}, {"fr": "J'ai une chose √† dire", "nl": "Ik heb een ding om te zeggen"}, {"fr": "J'ai annul√© mon voyage", "nl": "Ik heb mijn reis geannuleerd"}, {"fr": "Tout est stupide", "nl": "Alles is stom"}, {"fr": "Puis-je en avoir deux de ceux-ci ?", "nl": "Mag ik er twee van die hebben?"}, {"fr": "Puis-je avoir deux kilos de poulet, s'il vous pla√Æt ?", "nl": "Mag ik twee kilo kip, alstublieft?"}, {"fr": "Avez-vous des ≈ìufs dans votre magasin ?", "nl": "Heeft u eieren in uw winkel?"}, {"fr": "Je cherche du sel dans votre magasin.", "nl": "Ik zoek zout in uw winkel."}, {"fr": "Je cherche du sel dans votre magasin. Pourriez-vous me dire o√π je peux le trouver ?", "nl": "Ik zoek zout in uw winkel. Kunt u mij zeggen waar ik het kan vinden?"}, {"fr": "Je ne peux pas le trouver.", "nl": "Ik kan het niet vinden"}, {"fr": "J‚Äôarrive pas √† trouver o√π il est", "nl": "Ik kan niet vinden waar het is"}, {"fr": "O√π puis-je trouver le sel dans votre magasin ?", "nl": "Waar kan ik het zout in jouw winkel vinden?"}, {"fr": "O√π puis-je trouver le sel ?", "nl": "Waar kan ik het zout vinden?"}];

// ---------------------------------------------------------------------------
//  Remembered state
// ---------------------------------------------------------------------------
let remembered = {};
try { remembered = JSON.parse(localStorage.getItem('flashcardRemembered')) || {}; }
catch(e) {}
function saveRemembered() {
    localStorage.setItem('flashcardRemembered', JSON.stringify(remembered));
}

// ---------------------------------------------------------------------------
//  Voice settings blob ‚Äì one per language
// ---------------------------------------------------------------------------
const voiceSettings = Object.fromEntries(
    LANGS.map(l => [l, {voiceURI:null, rate:1, pitch:1}])
);
try {
  Object.assign(voiceSettings,
        JSON.parse(localStorage.getItem('flashcardVoiceSettings')||'{}'));
} catch(e){}

// ---------------------------------------------------------------------------
//  Populate <select> for every language when voices load
// ---------------------------------------------------------------------------
function populateVoiceSelects() {
  const vlist = speechSynthesis.getVoices();
  document.querySelectorAll('.lang-settings').forEach(cfg => {
      const lang = cfg.dataset.lang;
      const sel  = cfg.querySelector('.voice-select');
      sel.innerHTML = '';
      vlist.filter(v => v.lang.startsWith(lang))
           .forEach(v => sel.append(new Option(`${v.name} (${v.lang})`, v.voiceURI)));
      if (voiceSettings[lang].voiceURI)
          sel.value = voiceSettings[lang].voiceURI;
  });
}
speechSynthesis.onvoiceschanged = populateVoiceSelects;

// ---------------------------------------------------------------------------
//  Build one card DOM node
// ---------------------------------------------------------------------------
function createCard(data, idx) {
  const card   = document.createElement('div');
  card.className = 'flashcard';
  card.dataset.side = 0;

  const badge  = document.createElement('span');
  badge.className = 'remembered-badge';
  badge.textContent = 'Remembered ‚úì';
  card.append(badge);

  const content = document.createElement('div');
  content.className = 'content';
  card.append(content);

  const render = () => { content.textContent = data[ LANGS[ +card.dataset.side ] ] || ''; };
  render();

  // cycle through sides
  card.onclick = (e) => {
      if (e.target.closest('button')) return;        // ignore buttons
      card.dataset.side = (+card.dataset.side + 1) % LANGS.length;
      render();
  };

  // buttons row
  const btns = document.createElement('div');
  btns.className = 'buttons';
  card.append(btns);

  // remember button
  const rem = document.createElement('button');
  rem.className = 'remember-button';
  const applyR = (st) => {
      card.classList.toggle('remembered', st);
      rem.classList.toggle('remembered', st);
      rem.textContent = st ? 'Unmark Remembered' : 'Mark as Remembered';
  };
  applyR(!!remembered[idx]);
  rem.onclick = () => {
      remembered[idx] = !remembered[idx];
      applyR(remembered[idx]);
      saveRemembered();
  };
  btns.append(rem);

  // play (TTS) button
  const play = document.createElement('button');
  play.className = 'play-button';
  play.textContent = 'üîä';
  play.onclick = () => {
      const side = +card.dataset.side;
      const lang = LANGS[side];
      const txt  = data[lang] || '';
      const u    = new SpeechSynthesisUtterance(txt);
      const cfg  = voiceSettings[lang];
      if (cfg.voiceURI)
          u.voice = speechSynthesis.getVoices().find(v => v.voiceURI === cfg.voiceURI);
      else
          u.lang = lang;
      u.rate  = cfg.rate;  u.pitch = cfg.pitch;
      speechSynthesis.speak(u);
  };
  btns.append(play);

  return card;
}

// ---------------------------------------------------------------------------
//  Settings modal ‚Äì open / close, sliders, <select> binding
// ---------------------------------------------------------------------------
const modal = document.getElementById('settings-modal');
document.getElementById('settings-button').onclick = () => {
    populateVoiceSelects();
    modal.style.display = 'flex';
};
modal.querySelector('.close').onclick = () => {
    modal.style.display = 'none';
    localStorage.setItem('flashcardVoiceSettings', JSON.stringify(voiceSettings));
};
document.querySelectorAll('.lang-settings').forEach(cfg => {
    const lang = cfg.dataset.lang;
    cfg.querySelector('.voice-select').onchange = e =>
        voiceSettings[lang].voiceURI = e.target.value;

    const rate = cfg.querySelector('.rate-range'),
          rv   = cfg.querySelector('.rate-value');
    rate.oninput = e => { rv.textContent = e.target.value;
                          voiceSettings[lang].rate = +e.target.value; };
    rate.value      = voiceSettings[lang].rate;
    rv.textContent  = rate.value;

    const pitch = cfg.querySelector('.pitch-range'),
          pv    = cfg.querySelector('.pitch-value');
    pitch.oninput = e => { pv.textContent = e.target.value;
                           voiceSettings[lang].pitch = +e.target.value; };
    pitch.value     = voiceSettings[lang].pitch;
    pv.textContent  = pitch.value;
});

// ---------------------------------------------------------------------------
//  Flip-all button
// ---------------------------------------------------------------------------
document.getElementById('flip-all-button').onclick = () => {
    document.querySelectorAll('.flashcard').forEach((c,i) => {
        c.dataset.side = 0;
        c.querySelector('.content').textContent = CARDS[i][ LANGS[0] ] || '';
    });
};

// ---------------------------------------------------------------------------
//  Build all cards on DOM ready
// ---------------------------------------------------------------------------
window.addEventListener('DOMContentLoaded', () => {
    const cont = document.getElementById('card-container');
    CARDS.forEach( (d,i) => cont.append( createCard(d,i) ) );
    if ('serviceWorker' in navigator)
        navigator.serviceWorker.register('sw.js');
});
</script>
<p style="margin:20px 0;">
  <a href="index_nl.html">‚Üê Back to Nederlands index</a>
</p>
</body></html>